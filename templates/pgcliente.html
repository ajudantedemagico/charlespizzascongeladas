<!DOCTYPE html>
<html lang="PT-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/CSS/pedidos.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="icon" href="/static/img/pizza_7.png" type="image/png">
    <title>Área do Cliente</title>
</head>
<body>
    <h1 class="titulo">ÁREA DO CLIENTE</h1>
    <main>
        <section>
            <h1 class="nomecli">Olá {{ nome_usuario }} Bem-vindo(a) á sua página de pedidos!</h1>
            <div class="meus"><b>SEU ENDEREÇO</b></div>
            <div class="infocli">
                <p><strong>Endereço:</strong> {{ usuario.rua }}, nº {{ usuario.numero }}, CEP {{ usuario.cep }}, {{ usuario.ponto_referencia }}</p>
                <div class="botaoalterar">
                    <button class="botaoalterar"><b>ALTERAR</b></button>
                </div>
            </div>

            <div class="container">
                <div class="meus"><b>MEUS PEDIDOS</b></div>
                
                {% if pedidos %}
                    {% for pedido in pedidos %}
                        <div class="pedido">
                            <p><b>Pedido ID:</b> {{ pedido.id_pedido }}</p>
                            <p><b>Itens:</b></p>
                            <ul>
                            {% for item in pedido.itens %}
                                <li>{{ item.sabor }} - {{ item.quantidade }}x - R$ {{ "%.2f"|format(item.preco_unitario) }}</li>
                            {% endfor %}
                            </ul>
                            <p><b>Total do pedido:</b> R$ {{ '%.2f'|format(pedido.total) }}</p>
                            <p><b>Data de entrega:</b> {{ pedido.data_entrega | datetimeformat }}</p>


                            <div class="botaovermais">
                                <button class="botaovermais"><b>VER MAIS</b></button>
                            </div> 

                            <form method="post" action="/cancelar-pedido/{{ pedido.id_pedido }}" onsubmit="return confirmarCancelamento(event)">
                                <button type="submit" class="botao-cancelar">CANCELAR PEDIDO</button>
                            </form>

                        </div>
                    {% endfor %}
                {% else %}
                    <p>Você ainda não fez nenhum pedido.</p>
                {% endif %}
            </div>

            <div class="container">
                <div class="meus"><b>MEUS CUPONS</b></div>
                <div class="pedido">
                    <p>conteúdo</p>
                    <div class="botaovermais">
                        <button class="botaovermais"><b>VER MAIS</b></button>
                    </div>            
                </div>
            </div>
        </section>
    </main>
    <script>
    function confirmarCancelamento(event) {
        event.preventDefault(); // Impede envio imediato

        if (confirm("Tem certeza que deseja cancelar o pedido?")) {
            event.target.submit(); // Envia se confirmar
        }

        return false; // Sempre bloqueia envio automático
    }
</script>

    <script src="/static/JS/nav.js"></script>
    <script src="/static/JS/footer.js"></script>
    <script src="/static/JS/btnTopo.js"></script>
</body>
</html>
